apply plugin: 'com.android.application'
apply plugin: 'com.jakewharton.butterknife'
apply plugin: 'com.alibaba.arouter'
apply plugin: 'org.greenrobot.greendao'
apply plugin: 'com.google.protobuf'

def getCurrentTime() {
    return new Date().format("yyyy-MM-dd", TimeZone.getTimeZone("UTC"))
}

android {
    compileSdkVersion 28
    defaultConfig {
        applicationId "com.bochat.app"
        flavorDimensions "default"
        minSdkVersion 19
        targetSdkVersion 28
        versionCode 1060
        versionName "1.0.6"
        multiDexEnabled true
        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
        javaCompileOptions {
            annotationProcessorOptions {
                arguments = [AROUTER_MODULE_NAME: project.getName()]
            }
        }

        ndk {
            //选择要添加的对应cpu类型的.so库。
            abiFilters 'armeabi', 'armeabi-v7a', 'arm64-v8a',"x86_64",'x86'
            // 还可以添加 'x86', 'x86_64', 'mips', 'mips64'
        }
    }

    sourceSets {
        main {
            jni.srcDirs = []
            jniLibs.srcDirs = ['libs']
            java {
                srcDir 'src/main/java'
            }
            proto {
                srcDir 'src/main/proto'
            }
        }
    }

    signingConfigs {
        release {
            storePassword "bochat2019"
            keyAlias "boChat"
            keyPassword "bochat2019"
            storeFile file('../keystore/bochat.jks')
            v1SigningEnabled true
            v2SigningEnabled true
        }
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
            signingConfig signingConfigs.release
            android.applicationVariants.all { variant ->
                variant.outputs.all {
                    outputFileName = "BoChat_v${defaultConfig.versionName}_${getCurrentTime()}_release.apk"
                }
            }
        }
        debug{
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
            signingConfig signingConfigs.debug
        }
    }

    lintOptions {
        checkReleaseBuilds false
        abortOnError false
    }

    productFlavors {
        api_online {
            resValue "string", "app_name", "博信"
            applicationId "com.bochat.app"
            manifestPlaceholders = [RONG_KEY: "tdrvipkstycz5"]
            buildConfigField "String", "API_HOST", "\"api-app.bochat.net\""
            buildConfigField "String", "QAPI_HOST", "\"api-trade.bochat.net\""
            buildConfigField "String", "WAPI_HOST", "\"api-websocket.bochat.net\""
            buildConfigField "boolean", "IS_DEBUG", "false"
        }
        api_develop {
            resValue "string", "app_name", "博信开发"
            applicationId "com.bochat.app"
            manifestPlaceholders = [RONG_KEY: "k51hidwqk46ob"]
//            //开发环境
            buildConfigField "String", "API_HOST", "\"47.244.177.24:8585\""
            buildConfigField "String", "QAPI_HOST", "\"47.244.177.24:8787\""
            buildConfigField "String", "WAPI_HOST", "\"47.244.177.24:7397\""
            buildConfigField "boolean", "IS_DEBUG", "true"
        }
        api_57 {
            resValue "string", "app_name", "博信测试"
            manifestPlaceholders = [RONG_KEY: "kj7swf8ok3f22"]
            applicationId "com.bochat.app"
            buildConfigField "String", "API_HOST", "\"192.168.0.57:8585\""
            buildConfigField "String", "QAPI_HOST", "\"192.168.0.57:8787\""
            buildConfigField "String", "WAPI_HOST", "\"192.168.0.57:7397\""
            buildConfigField "boolean", "IS_DEBUG", "true"
        }
    }
}

greendao {
    schemaVersion 8// 版本号，升级时可配置
    daoPackage 'com.bochat.app.model.greendao'
    targetGenDir 'src/main/java'
}

protobuf {
    protoc {
        artifact = 'com.google.protobuf:protoc:3.0.0'
    }

    generateProtoTasks {
        all().each { task ->
            task.builtins {
                remove java
            }
            task.builtins {
                java { }
                cpp { }
            }
        }
    }
}


dependencies {
    implementation fileTree(include: ['*.jar'], dir: 'libs')
    implementation 'com.android.support:appcompat-v7:28.0.0'
    implementation 'com.android.support.constraint:constraint-layout:1.1.3'
    testImplementation 'junit:junit:4.12'
    androidTestImplementation 'com.android.support.test:runner:1.0.2'
    androidTestImplementation 'com.android.support.test.espresso:espresso-core:3.0.2'
    implementation 'com.google.dagger:dagger:2.15'
    annotationProcessor 'com.google.dagger:dagger-compiler:2.15'
    implementation 'com.liaoinstan.springview:library:1.3.0'
    implementation 'com.jakewharton:butterknife:8.4.0'
    annotationProcessor "com.jakewharton:butterknife-compiler:8.4.0"
    implementation 'com.jaeger.statusbarutil:library:1.5.1'
    implementation 'com.github.crossoverone:StatusBarUtil:1.3.3'
    implementation 'io.reactivex.rxjava2:rxjava:2.2.2'
    implementation 'io.reactivex.rxjava2:rxandroid:2.1.0'
    implementation 'com.alibaba:arouter-api:1.4.1'
    annotationProcessor "com.alibaba:arouter-compiler:1.2.2"
    implementation 'com.ashokvarma.android:bottom-navigation-bar:2.1.0'
    implementation 'com.github.crossoverone:StatusBarUtil:1.3.3'
    implementation 'com.github.razerdp:BasePopup:2.1.8'
    implementation 'com.squareup.retrofit2:retrofit:2.3.0'
    implementation 'com.squareup.retrofit2:converter-gson:2.0.2'
    implementation 'com.squareup.retrofit2:adapter-rxjava:2.0.2'
    implementation 'com.squareup.retrofit2:converter-scalars:2.0.0-beta4'
    implementation 'com.alibaba:fastjson:1.2.38'
    implementation 'com.github.bumptech.glide:okhttp3-integration:4.9.0'
    implementation 'org.greenrobot:greendao:3.0.0'
    implementation project(':IMKit')
    implementation project(':IMLib')
    implementation 'com.wang.avi:library:2.1.3'
    implementation 'com.zhy:base-adapter:3.0.3'
    implementation 'com.zhy:base-rvadapter:3.0.3'
    implementation 'com.android.support:support-v4:28.0.0'
    implementation 'com.contrarywind:Android-PickerView:4.1.8'
    implementation 'org.greenrobot:eventbus:3.1.1'
    implementation 'com.zhihu.android:matisse:0.5.2-beta4'
    implementation 'com.github.tbruyelle:rxpermissions:0.10.2'
    implementation 'com.aliyun.dpa:oss-android-sdk:+'
    implementation 'com.belerweb:pinyin4j:2.5.1'
    implementation 'com.github.FJ917:FJEditTextCount:1.0.4'
    implementation 'com.squareup.okhttp3:logging-interceptor:3.8.1'
    implementation 'com.android.support:multidex:1.0.0'
    implementation files('libs/zxing.jar')
    implementation files('libs/universal-image-loader-1.9.5.jar')
    implementation files('libs/alipaySdk-15.6.2-20190416165100-noUtdid.aar')
    implementation files('libs/open_sdk_r6008_lite.jar')
    implementation 'com.tencent.mm.opensdk:wechat-sdk-android-with-mta:+'
    implementation 'com.flyco.tablayout:FlycoTabLayout_Lib:2.1.2@aar'
    implementation 'top.zibin:Luban:1.1.8'
    implementation 'com.scwang.smartrefresh:SmartRefreshLayout:1.1.0-alpha-28'
    implementation 'com.scwang.smartrefresh:SmartRefreshHeader:1.1.0-alpha-28'
    implementation(name: 'libsecurity-release', ext: 'aar')
    implementation 'com.android.support:cardview-v7:28.0.0'
    implementation 'com.github.Hitomis:CrazyShadow:v1.0.1'

    implementation(name: 'captcha-release_v3.0.0', ext: 'aar')
    //aar名称和版本号以下载下来的最新版为准
    implementation 'com.github.fodroid:XRadioGroup:1.5'
    implementation "org.java-websocket:Java-WebSocket:1.3.9"

    implementation 'com.gyf.immersionbar:immersionbar:3.0.0-beta02'
    implementation 'com.jaeger.statusbarutil:library:1.5.1'

    implementation 'com.scwang.smartrefresh:SmartRefreshLayout:1.1.0-alpha-24'
    implementation 'com.scwang.smartrefresh:SmartRefreshHeader:1.1.0-alpha-24'

    implementation 'com.google.protobuf:protobuf-java:3.4.0'
    implementation "com.github.bumptech.glide:okhttp3-integration:4.0.0"
//    implementation 'com.felipecsl:gifimageview:2.2.0'
    implementation 'pl.droidsonroids.gif:android-gif-drawable:1.2.7'

}


